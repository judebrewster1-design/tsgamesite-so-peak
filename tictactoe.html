<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tic-Tac-Toe JudeVerse</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(120deg, #ff9a9e, #fad0c4);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    margin: 0;
    padding: 20px;
  }
  h1 { color: #333; }
  #board {
    display: grid;
    grid-template-columns: repeat(3, 100px);
    grid-gap: 5px;
    margin: 20px 0;
  }
  .cell {
    width: 100px;
    height: 100px;
    background: white;
    border: 2px solid #333;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5em;
    cursor: pointer;
    user-select: none;
  }
  #chat {
    width: 320px;
    margin-top: 20px;
  }
  #messages {
    border: 1px solid #333;
    height: 150px;
    overflow-y: auto;
    background: #fff;
    padding: 5px;
    margin-bottom: 5px;
  }
  input, button {
    padding: 5px;
    font-size: 1em;
  }
</style>
</head>
<body>
<h1>Tic-Tac-Toe JudeVerse</h1>
<div>
    <label>Game ID: <input id="gameId" value="room1"></label>
    <label>Player: <input id="playerId" value="X"></label>
    <button id="connectBtn">Connect</button>
</div>
<div id="board">
  <div class="cell" data-index="0"></div>
  <div class="cell" data-index="1"></div>
  <div class="cell" data-index="2"></div>
  <div class="cell" data-index="3"></div>
  <div class="cell" data-index="4"></div>
  <div class="cell" data-index="5"></div>
  <div class="cell" data-index="6"></div>
  <div class="cell" data-index="7"></div>
  <div class="cell" data-index="8"></div>
</div>
<div id="chat">
    <div id="messages"></div>
    <input id="chatInput" placeholder="Type message...">
    <button id="sendBtn">Send</button>
</div>

<script>
let ws;
const cells = document.querySelectorAll('.cell');
const messages = document.getElementById('messages');

document.getElementById('connectBtn').onclick = () => {
    const gameId = document.getElementById('gameId').value;
    const playerId = document.getElementById('playerId').value;
    
    // Replace this with your current LocalTunnel URL
    const url = `wss://funny-turkeys-unite.loca.lt/ws/${gameId}/${playerId}`;
    ws = new WebSocket(url);

    ws.onopen = () => {
        messages.innerHTML += '<div><em>Connected to server</em></div>';
    };

    ws.onmessage = (event) => {
        const data = event.data;
        if (data.startsWith("Message blocked")) {
            messages.innerHTML += `<div style="color:red">${data}</div>`;
            return;
        }
        const boardData = data.split(",");
        boardData.forEach((val, i) => {
            cells[i].textContent = val;
        });
    };

    ws.onclose = () => {
        messages.innerHTML += '<div><em>Disconnected from server</em></div>';
    };
};

cells.forEach(cell => {
    cell.addEventListener('click', () => {
        if (!ws) return alert("Connect first");
        const player = document.getElementById('playerId').value;
        ws.send(`${cell.dataset.index}:${player}`);
    });
});

document.getElementById('sendBtn').onclick = () => {
    if (!ws) return alert("Connect first");
    const msg = document.getElementById('chatInput').value.trim();
    if(msg) {
        ws.send(msg);
        document.getElementById('chatInput').value = "";
    }
};
</script>
</body>
</html>
